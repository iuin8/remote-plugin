# Remote plugin configuration template
# Generated by Gradle Remote Plugin

# Environment configurations
# Each environment can have its own settings
environments:
  # Development environment configuration
  dev:
    extends: base
    ssh:
      server: your-server-hostname
    jenkins:
      job: "your-job-name"

  prod:
    extends: base
    ssh:
      server: prod-server-hostname
    jenkins:
      job: "prod-job-name"
    start:
      # 是否需要用户确认(用于生产等环境, 防止误操作执行了发布等任务)
      need_confirm: true

# Test environment configuration
#  test:
#    extends: other
#    ssh:
#      server: test-server-hostname
#    service_ports:
#      app: 8080
#    log:
#      filePattern: ${REMOTE_BASE_DIR}/../logs/${service}.log
#    jenkins:
#      url: "https://your-jenkins-url-1.com"
#      user: "your_username_1"
#      token: "your_api_token_1"
#      job: "your-job-name-1"

# Base configuration (can be extended by environments)
common:
  base:
    jenkins:
      url: "https://your-jenkins-url.com"
      user: "your_username"
      token: "your_api_token"
    remote:
      base_dir: /path/to/your/app
    env:
      # JDK 8
      # JAVA_TOOL_OPTIONS: -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=3${SERVICE_PORT}
      # JDK 9+
      JAVA_TOOL_OPTIONS: -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:3${SERVICE_PORT}
    start:
      # command: ${REMOTE_BASE_DIR}/${SERVICE_NAME}/${SERVICE_NAME}-start.sh
      command: sudo systemctl restart ${SERVICE_NAME}
      # build_task: bootJar  # 构建任务名称，默认为 bootJar
    log:
      filePattern: ${REMOTE_BASE_DIR}/../logs/${service}.log
    service_ports:
        app: 8080
    ssh:
      user: www  # 远程执行命令的用户，不配置则使用当前 SSH 用户
      use_tty: false  # 是否强制分配伪终端，默认逻辑已智能处理，一般无需配置
      setup:
        auto:
          keygen: false  # 是否自动生成密钥，默认 false
        key:
          type: ed25519  # 密钥类型，默认 ed25519
#  other:
#    remote:
#      base_dir: /path/to/your/app

# Supported placeholders:
#   - ${service}            : current Gradle project name
#   - ${REMOTE_BASE_DIR}    : value of remote.base.dir
#   - ${remote.base.dir}    : same as above
#   - ${SERVICE_NAME}       : same as ${service}
#   - ${SERVICE_PORT}       : service port